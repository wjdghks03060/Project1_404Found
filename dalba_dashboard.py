import streamlit as st

st.set_page_config(
    page_title="달바(d'Alba) 마케팅 대시보드",
    page_icon="✨",
    layout="wide"
)

# --- [1] 기존 프로젝트 개요 (동일) ---
st.title("✨ 달바(d'Alba) 인플루언서 마케팅 대시보드")
st.markdown("""
## 💡 프로젝트 개요
이 대시보드는 달바의 인플루언서 마케팅 의사결정을 자동화하고 최적화하기 위해 제작되었습니다.

- **Seeding 평가:** 데이터에 기반해 '최적의' 인플루언서를 예측하고 선정합니다.
- **성과 분석:** 캠페인 성과(ROAS, CPC 등)를 자동으로 분석하고 리포팅합니다.
- **기준 정보 관리:** 새로운 캠페인, 제품 등의 정보를 관리합니다.
""")

st.divider() # 구분선

# --- [2] (신규) 각 페이지 상세 기능 설명 ---
st.header("📖 각 페이지 상세 기능 설명")
st.markdown("이 대시보드가 제공하는 3가지 핵심 기능 페이지를 소개합니다.")

# 2-1. 3개의 탭을 생성
tab1, tab2, tab3 = st.tabs([
    "1. 🎯 Seeding 평가", 
    "2. 📊 성과 분석 대시보드", 
    "3. 📝 기준 정보 관리"
])

# 2-2. 탭 1 (Seeding) 설명
with tab1:
    st.subheader("🎯 Seeding 평가 (미래 예측)")
    st.markdown("""
    **"어떤 인플루언서에게 우리 제품을 맡겨야 할까?"** 라는 질문에 답하는 페이지입니다.
    
    `influencer_master.csv` 데이터를 기반으로, **'미래 성과'**를 예측하고 최적의 인플루언서를 필터링합니다.
    
    #### 🔍 핵심 기능
    * **사이드바 필터:**
        * `메인 카테고리`: ('뷰티', '라이프스타일' 등)
        * `팔로워 수`: (슬라이더로 조절)
        * `GenAI 브랜드 적합도`: (우리가 GenAI로 분석한 '핏' 점수)
    * **결과 테이블:**
        * 필터링된 인플루언서의 스펙(참여율, 예상 비용 등)을 한눈에 비교합니다.
        * `GenAI 적합도`와 `GenAI 분석 이유`를 통해 '왜' 이 인플루언서가 적합한지 정성적인 근거를 제시합니다.
    """)



# 2-3. 탭 2 (Dashboard) 설명
with tab2:
    st.subheader("📊 성과 분석 대시보드 (과거 분석)")
    st.markdown("""
    **"그래서, 마케팅 성과가 실제로 어땠지?"** 라는 질문에 답하는 메인 대시보드입니다.
    
    4개의 CSV 파일(`performance`, `campaign`, `product`, `influencer`)을 **모두 `JOIN`**하여 다각도로 성과를 분석합니다.
    
    #### 📈 핵심 KPI (핵심 성과 지표)
    * `ROAS` (광고비 대비 수익률): **최종 목표**
    * `CTR` (노출 대비 클릭률): 콘텐츠 매력도
    * `CVR` (클릭 대비 전환율): 구매 매력도
    * `CPC` (클릭당 비용) / `CPA` (전환당 비용): 비용 효율성
    * `AOV` (평균 객단가): 고객 퀄리티
    
    #### 📊 핵심 차트
    * `날짜별 매출 추이 (Line)`: 언제 성과가 터졌는지 시계열 분석
    * `인플루언서 효율성 (Scatter)`: '비용 대비 매출'을 사분면으로 분석 (고효율/저효율 인플루언서 식별)
    * `플랫폼/카테고리별 성과 (Bar/Pie)`: '인스타 vs 유튜브', '세럼 vs 선케어' 성과 비교
    * `성과 랭킹 (Bar)`: '매출 1위 인플루언서', 'ROAS 1위 캠페인' 랭킹
    """)
  

# 2-4. 탭 3 (Admin) 설명
with tab3:
    st.subheader("📝 기준 정보 관리 (데이터 입/출력)")
    st.markdown("""
    **"새로운 캠페인을 등록하거나 삭제하자."** 라는 데이터 관리(CRUD) 페이지입니다.
    
    이 페이지는 **'실제로' `table/campaign_master.csv` 파일을 수정**하며, 그 결과는 2번 대시보드에 즉시 반영됩니다.
    
    #### ⚙️ 핵심 기능
    * **캠페인 '추가' (Create):**
        * '신규 캠페인 등록' 폼에 정보를 입력하고 '추가하기' 버튼을 누릅니다.
        * `pandas`가 `campaign_master.csv` 파일 맨 마지막 줄에 새 캠페인 정보를 **이어붙입니다. (`mode='a'`)**
    * **캠페인 '삭제' (Delete):**
        * '기존 캠페인 삭제' 드롭다운에서 삭제할 캠페인을 선택합니다.
        * `pandas`가 CSV 파일 전체를 읽어와, 선택된 행을 '제외'한 나머지를 **파일 전체에 '덮어씁니다'. (`mode='w'`)**
    * **[핵심] 즉시 반영 로직:**
        * '추가' 또는 '삭제'가 성공하면, `st.cache_data.clear()` 명령이 실행됩니다.
        * 이는 Streamlit이 '임시 저장(캐시)'해 둔 옛날 CSV 정보를 강제로 '삭제'시킵니다.
        * 따라서, 관리자가 2번 대시보드로 돌아가면 **'변경된 최신 CSV'**를 다시 읽어오므로, **방금 추가/삭제한 캠페인이 즉시 반영**됩니다.
    """)
   